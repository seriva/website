## Cursor Rules: Portfolio Website (Vanilla JS SPA)

Keep it fast, simple, and secure. No build tools. One SPA in `www/js/main.js`.

### Core Principles
- Use `html\`...\`` templates everywhere; all user content auto-escapes
- Use `${safe(trustedHtml)}` only for trusted, internal HTML strings
- Call `await getData()` before reading config/content (cached in `projectsData`)
- Route with URL params: `?blog`, `?project=id`, `?page=id`
- Always call `closeMobileMenu()` and update `<title>` in route handlers
- Keep functions grouped by existing comment sections in `main.js`
- All magic numbers go in `CONSTANTS` object

### Don't
- Don't introduce frameworks/build steps or server logic
- Don't concatenate raw HTML strings; don't bypass escaping without `safe()`
- Don't use hash routing; keep the `URLSearchParams` pattern

### Quality Gate
- Format: `biome format --write .`
- Lint: `biome check .`
- Tests: open `www/tests.html` (QUnit)
- **All changes must pass lint + tests**
- Update `README.md` if adding features or changing setup

### Key Patterns
- Templates: `Templates.* = (args) => html\`...\``
- Markdown: `MarkdownLoader.loadAsHtml(path)` for pages/posts
- Search: `Search.init()` with 300ms debounce
- Comments: `Templates.giscusComments(data?.site?.comments, "blog"|"projects")`
- Theme: `applyColorScheme()` + `applyPrismTheme()` before code render

### Files
- `www/js/main.js` - all app logic
- `www/data/content.yaml` - all content + config
- `www/css/main.css` - all styles
- `www/tests/` - QUnit tests
